# 🚀 快速部署指南（5分钟完成）

## 方案：Vercel（前端）+ Railway（后端）

**用户使用方式：通过浏览器访问网址，无需下载安装**

---

## 📋 部署前准备

### 1. 确保代码已提交到GitHub

```bash
cd F:\ProReport-GenAI

# 初始化Git（如果还没有）
git init

# 添加所有文件
git add .

# 提交
git commit -m "Initial commit: ProReport GenAI with backend"

# 在GitHub创建仓库后，添加远程仓库
git remote add origin https://github.com/your-username/proreport-genai.git
git branch -M main
git push -u origin main
```

### 2. 准备环境变量

**后端需要的环境变量：**
- `GEMINI_API_KEY` - 你的Gemini API密钥
- `JWT_SECRET` - 随机字符串（用于JWT加密）
- `FRONTEND_URL` - 前端部署后的URL（稍后填写）

---

## 🌐 步骤1：部署前端到Vercel

### 1.1 访问Vercel
打开浏览器访问：https://vercel.com

### 1.2 登录/注册
使用GitHub账号登录

### 1.3 创建新项目
1. 点击 **"Add New..."** → **"Project"**
2. 选择你的GitHub仓库 `proreport-genai`
3. 点击 **"Import"**

### 1.4 配置项目

**Framework Preset:** 选择 `Vite`（或留空，Vercel会自动检测）

**Root Directory:** 留空（使用根目录）

**Build and Output Settings:**
- **Build Command:** `npm run build:client`
- **Output Directory:** `dist`
- **Install Command:** `npm install`

**Environment Variables:**
暂时不添加，等后端部署完成后再添加：
- `VITE_API_URL` = 后端URL（稍后填写）

### 1.5 部署
点击 **"Deploy"**

等待部署完成（约2-3分钟）

### 1.6 获取前端URL
部署完成后，Vercel会提供URL，例如：
```
https://proreport-genai.vercel.app
```

**先复制这个URL，稍后需要用到！**

---

## 🔧 步骤2：部署后端到Railway

### 2.1 访问Railway
打开浏览器访问：https://railway.app

### 2.2 登录/注册
使用GitHub账号登录

### 2.3 创建新项目
1. 点击 **"New Project"**
2. 选择 **"Deploy from GitHub repo"**
3. 选择你的仓库 `proreport-genai`
4. 点击 **"Deploy Now"**

### 2.4 配置项目

**设置根目录：**
1. 点击项目进入详情
2. 点击 **"Settings"** 标签
3. 找到 **"Root Directory"**
4. 设置为：`server`
5. 保存

### 2.5 配置环境变量

点击 **"Variables"** 标签，添加以下环境变量：

```
GEMINI_API_KEY=AIzaSyD7L7GzfFwFu0BVA5N0EEOKCIe20mlAeK8
JWT_SECRET=proreport-genai-secret-key-2024-change-this
NODE_ENV=production
DATA_PATH=./data
FRONTEND_URL=https://proreport-genai.vercel.app
```

**注意：**
- `FRONTEND_URL` 填写步骤1.6中获取的Vercel URL
- `JWT_SECRET` 建议使用随机字符串（可以使用在线生成器）

### 2.6 配置构建和启动

Railway会自动检测，但可以手动配置：

**Build Command:** `npm run build`

**Start Command:** `npm start`

### 2.7 获取后端URL

部署完成后：
1. 点击 **"Settings"** → **"Networking"**
2. 点击 **"Generate Domain"** 生成公共域名
3. 复制这个URL，例如：
```
https://proreport-genai-production.up.railway.app
```

**这个就是后端API地址！**

---

## 🔗 步骤3：连接前后端

### 3.1 更新前端环境变量

回到Vercel：
1. 进入项目
2. 点击 **"Settings"** → **"Environment Variables"**
3. 添加环境变量：
   - **Name:** `VITE_API_URL`
   - **Value:** `https://your-railway-url.up.railway.app/api`
   - **Environment:** Production, Preview, Development（全选）
4. 保存

### 3.2 重新部署前端

在Vercel中：
1. 点击 **"Deployments"** 标签
2. 找到最新的部署
3. 点击 **"..."** → **"Redeploy"**
4. 等待重新部署完成

---

## ✅ 步骤4：验证部署

### 4.1 检查后端

访问：`https://your-railway-url.up.railway.app/api/health`

应该看到：
```json
{"success":true,"message":"Server is running"}
```

### 4.2 检查前端

访问：`https://your-app.vercel.app`

应该看到应用界面。

### 4.3 测试功能

1. 注册新账号
2. 登录
3. 创建项目
4. 测试生成功能

---

## 📝 给用户的说明

### 用户使用说明

创建 `用户访问说明.txt`：

```
========================================
ProReport GenAI - 专业可行性研究报告生成工具
========================================

🌐 访问地址：https://your-app.vercel.app

📱 使用方式：
1. 打开浏览器（Chrome、Edge、Firefox等）
2. 访问上述网址
3. 首次使用请注册账号
4. 登录后开始使用

✅ 优势：
- 无需下载安装
- 支持所有设备（电脑/手机/平板）
- 自动更新，始终使用最新版本
- 数据云端存储，多设备同步

📋 系统要求：
- 现代浏览器（Chrome 90+, Edge 90+, Firefox 88+）
- 网络连接

🆘 需要帮助？
如有问题，请联系技术支持。

========================================
```

---

## 🔄 更新部署

### 更新代码后重新部署

**前端（Vercel）：**
- 推送代码到GitHub后，Vercel会自动重新部署

**后端（Railway）：**
- 推送代码到GitHub后，Railway会自动重新部署
- 或手动点击 "Redeploy"

---

## ⚙️ 环境变量管理

### 前端环境变量（Vercel）
- `VITE_API_URL` - 后端API地址

### 后端环境变量（Railway）
- `GEMINI_API_KEY` - Gemini API密钥
- `JWT_SECRET` - JWT加密密钥
- `FRONTEND_URL` - 前端URL（用于CORS）
- `NODE_ENV` - 环境（production）
- `DATA_PATH` - 数据存储路径

---

## 🎯 部署完成检查清单

- [ ] 前端已部署到Vercel
- [ ] 后端已部署到Railway
- [ ] 环境变量已正确配置
- [ ] 前后端已连接（前端能调用后端API）
- [ ] 健康检查通过
- [ ] 可以注册账号
- [ ] 可以登录
- [ ] 可以创建项目
- [ ] 可以生成内容

---

## 🐛 常见问题

### 问题1：前端无法连接后端

**检查：**
1. `VITE_API_URL` 是否正确配置
2. 后端URL是否可访问
3. CORS配置是否正确

### 问题2：后端启动失败

**检查：**
1. 环境变量是否全部配置
2. `GEMINI_API_KEY` 是否有效
3. Railway日志查看错误信息

### 问题3：CORS错误

**解决：**
在Railway环境变量中，确保 `FRONTEND_URL` 包含完整的前端URL（带https://）

---

## 📊 费用说明

### Vercel（前端）
- **免费额度：** 100GB带宽/月
- **适合：** 中小型应用完全免费

### Railway（后端）
- **免费额度：** $5/月免费额度
- **适合：** 小型应用完全免费
- **超出后：** 按使用量付费

**对于大多数场景，完全免费！**

---

## 🎉 完成！

部署完成后，用户只需要：
1. 打开浏览器
2. 访问你提供的网址
3. 开始使用

**无需下载、无需安装、自动更新！**

