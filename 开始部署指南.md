# 🚀 开始部署 - 详细步骤

## 📋 部署流程

```
GitHub仓库 → Vercel(前端) → Railway(后端) → 连接前后端 → 完成！
```

**预计时间：5-10分钟**

---

## 🌐 步骤1：部署前端到Vercel

### 1.1 访问Vercel

1. 打开浏览器访问：**https://vercel.com**
2. 点击右上角 **"Sign Up"** 或 **"Log In"**
3. 选择 **"Continue with GitHub"** 使用GitHub账号登录

### 1.2 创建新项目

1. 登录后，点击 **"Add New..."** → **"Project"**
2. 在 **"Import Git Repository"** 中，找到你的仓库：
   - `a706990060-sys/proreport-genai`
3. 点击仓库右侧的 **"Import"** 按钮

### 1.3 配置项目

**Framework Preset:** 
- 选择 `Vite` 或留空（Vercel会自动检测）

**Root Directory:** 
- 留空（使用根目录）

**Build and Output Settings:**
- **Build Command:** `npm run build:client`
- **Output Directory:** `dist`
- **Install Command:** `npm install`

**Environment Variables:**
- 暂时不添加，等后端部署完成后再添加

### 1.4 部署

1. 点击页面底部的 **"Deploy"** 按钮
2. 等待部署完成（约2-3分钟）
3. 部署过程中可以看到构建日志

### 1.5 获取前端URL

部署成功后，Vercel会显示：
- ✅ **Congratulations!** 页面
- 你的应用URL，例如：`https://proreport-genai.vercel.app`

**重要：复制这个URL，稍后需要用到！**

---

## 🔧 步骤2：部署后端到Railway

### 2.1 访问Railway

1. 打开浏览器访问：**https://railway.app**
2. 点击 **"Start a New Project"** 或 **"Log In"**
3. 选择 **"Login with GitHub"** 使用GitHub账号登录

### 2.2 创建新项目

1. 登录后，点击 **"New Project"**
2. 选择 **"Deploy from GitHub repo"**
3. 首次使用需要授权Railway访问GitHub
4. 授权后，选择你的仓库：`a706990060-sys/proreport-genai`
5. 点击 **"Deploy Now"**

### 2.3 配置项目

**设置根目录：**
1. 点击项目进入详情页
2. 点击服务（Service）卡片
3. 点击 **"Settings"** 标签
4. 找到 **"Root Directory"**
5. 设置为：`server`
6. 保存

**配置环境变量：**
1. 点击 **"Variables"** 标签
2. 点击 **"New Variable"** 添加以下变量：

```
GEMINI_API_KEY = AIzaSyD7L7GzfFwFu0BVA5N0EEOKCIe20mlAeK8
JWT_SECRET = proreport-secret-key-2024-change-this-in-production
FRONTEND_URL = https://your-app.vercel.app（步骤1.5获取的URL）
NODE_ENV = production
DATA_PATH = ./data
PORT = 3001
```

**注意**：
- `FRONTEND_URL` 需要填写步骤1.5获取的Vercel URL
- `JWT_SECRET` 建议改为更复杂的随机字符串

### 2.4 生成公共域名

1. 点击 **"Settings"** 标签
2. 找到 **"Generate Domain"** 或 **"Public Domain"** 部分
3. 点击 **"Generate Domain"** 按钮
4. Railway会生成一个URL，例如：
   ```
   https://proreport-genai-production.up.railway.app
   ```

**重要：复制这个URL，稍后需要用到！**

### 2.5 等待部署完成

- Railway会自动开始构建和部署
- 查看 **"Deployments"** 标签可以看到部署进度
- 等待部署完成（约3-5分钟）

---

## 🔗 步骤3：连接前后端

### 3.1 回到Vercel添加环境变量

1. 回到Vercel项目页面
2. 点击 **"Settings"** → **"Environment Variables"**
3. 点击 **"Add New"**
4. 添加环境变量：
   - **Key**: `VITE_API_URL`
   - **Value**: `https://your-railway-url.up.railway.app/api`
     （步骤2.4获取的Railway URL + `/api`）
5. 点击 **"Save"**

### 3.2 重新部署前端

1. 在Vercel项目页面
2. 点击 **"Deployments"** 标签
3. 找到最新的部署
4. 点击右侧的 **"..."** → **"Redeploy"**
5. 等待重新部署完成

---

## ✅ 部署完成！

### 访问链接

部署完成后，用户访问的链接是：
```
https://your-app.vercel.app
```

### 验证部署

1. 访问前端URL
2. 应该能看到登录界面
3. 尝试注册账号
4. 尝试创建项目

如果一切正常，说明部署成功！

---

## 📝 部署后维护

### 更新代码

1. 修改代码后，提交到GitHub：
   ```bash
   git add .
   git commit -m "更新说明"
   git push
   ```
2. Vercel和Railway会自动检测并重新部署

### 查看日志

- **Vercel**: 项目页面 → Deployments → 点击部署 → 查看日志
- **Railway**: 项目页面 → 服务 → 查看日志

### 管理环境变量

- **Vercel**: Settings → Environment Variables
- **Railway**: Variables 标签

---

## 🆘 遇到问题？

### 前端部署失败

- 检查构建命令是否正确
- 检查GitHub仓库是否正确
- 查看Vercel的构建日志

### 后端部署失败

- 检查Root Directory是否设置为`server`
- 检查环境变量是否配置正确
- 查看Railway的部署日志

### 前后端无法连接

- 检查Vercel的`VITE_API_URL`是否正确
- 检查Railway的`FRONTEND_URL`是否匹配前端URL
- 检查CORS配置

---

## 🎉 完成！

部署完成后，把前端URL分享给其他用户即可！

**用户只需：**
1. 打开浏览器
2. 访问你提供的URL
3. 注册/登录
4. 开始使用

**无需下载、无需安装！**

