# 📖 部署步骤详解（图文版）

## 🎯 目标

将ProReport GenAI部署到云端，让用户通过浏览器访问，无需下载安装。

---

## 第一步：准备GitHub仓库

### 1.1 创建GitHub仓库

1. 访问 https://github.com
2. 点击右上角 **"+"** → **"New repository"**
3. 填写信息：
   - Repository name: `proreport-genai`
   - Description: `专业可行性研究报告生成工具`
   - 选择 Public 或 Private
4. 点击 **"Create repository"**

### 1.2 上传代码到GitHub

在项目目录执行：

```bash
cd F:\ProReport-GenAI

# 如果还没有初始化Git
git init
git add .
git commit -m "Initial commit"

# 添加远程仓库（替换为你的仓库URL）
git remote add origin https://github.com/your-username/proreport-genai.git
git branch -M main
git push -u origin main
```

---

## 第二步：部署前端到Vercel

### 2.1 访问Vercel

打开：https://vercel.com

### 2.2 登录

点击 **"Sign Up"** 或 **"Log In"**
- 选择 **"Continue with GitHub"**
- 授权Vercel访问你的GitHub

### 2.3 创建项目

1. 点击 **"Add New..."** → **"Project"**
2. 在仓库列表中找到 `proreport-genai`
3. 点击 **"Import"**

### 2.4 配置项目

**项目设置：**
- **Project Name:** `proreport-genai`（或自定义）
- **Framework Preset:** `Vite`（Vercel会自动检测）

**构建设置：**
- **Root Directory:** 留空（使用根目录）
- **Build Command:** `npm run build:client`
- **Output Directory:** `dist`
- **Install Command:** `npm install`

**环境变量：**
暂时不添加，等后端部署完成后再添加。

### 2.5 部署

点击 **"Deploy"** 按钮

等待2-3分钟，Vercel会：
1. 安装依赖
2. 构建项目
3. 部署到CDN

### 2.6 获取URL

部署完成后，你会看到：
```
✅ Deployment successful!

Your project is live at:
https://proreport-genai.vercel.app
```

**复制这个URL！** 稍后需要用到。

---

## 第三步：部署后端到Railway

### 3.1 访问Railway

打开：https://railway.app

### 3.2 登录

点击 **"Start a New Project"**
- 选择 **"Login with GitHub"**
- 授权Railway访问你的GitHub

### 3.3 创建项目

1. 点击 **"New Project"**
2. 选择 **"Deploy from GitHub repo"**
3. 在列表中找到 `proreport-genai`
4. 点击仓库

### 3.4 配置项目

**设置根目录：**
1. 项目创建后，点击项目进入详情页
2. 点击 **"Settings"** 标签
3. 找到 **"Root Directory"**
4. 输入：`server`
5. 点击 **"Update"**

### 3.5 配置环境变量

1. 点击 **"Variables"** 标签
2. 点击 **"New Variable"** 添加以下变量：

| 变量名 | 值 | 说明 |
|--------|-----|------|
| `GEMINI_API_KEY` | `你的API密钥` | Gemini API密钥 |
| `JWT_SECRET` | `随机字符串` | JWT加密密钥（建议32字符以上） |
| `NODE_ENV` | `production` | 环境模式 |
| `DATA_PATH` | `./data` | 数据存储路径 |
| `FRONTEND_URL` | `https://xxx.vercel.app` | 前端URL（步骤2.6获取的） |

**生成JWT_SECRET：**
可以使用在线工具：https://randomkeygen.com/
选择 "CodeIgniter Encryption Keys" 中的任意一个

### 3.6 部署

Railway会自动开始部署：
1. 检测到Node.js项目
2. 运行 `npm install`
3. 运行 `npm run build`
4. 运行 `npm start`

等待部署完成（约3-5分钟）

### 3.7 获取后端URL

1. 部署完成后，点击 **"Settings"** → **"Networking"**
2. 点击 **"Generate Domain"**
3. Railway会生成一个公共域名，例如：
   ```
   https://proreport-genai-production.up.railway.app
   ```

**复制这个URL！** 这就是后端API地址。

---

## 第四步：连接前后端

### 4.1 更新前端环境变量

回到Vercel：

1. 进入项目页面
2. 点击 **"Settings"** → **"Environment Variables"**
3. 点击 **"Add New"**
4. 添加：
   - **Key:** `VITE_API_URL`
   - **Value:** `https://your-railway-url.up.railway.app/api`
     （替换为步骤3.7获取的后端URL + `/api`）
   - **Environment:** 全选（Production, Preview, Development）
5. 点击 **"Save"**

### 4.2 重新部署前端

1. 点击 **"Deployments"** 标签
2. 找到最新的部署记录
3. 点击右侧 **"..."** 菜单
4. 选择 **"Redeploy"**
5. 确认重新部署

等待重新部署完成（约1-2分钟）

---

## 第五步：验证部署

### 5.1 检查后端

在浏览器访问：
```
https://your-railway-url.up.railway.app/api/health
```

应该看到：
```json
{"success":true,"message":"Server is running"}
```

### 5.2 检查前端

在浏览器访问：
```
https://your-app.vercel.app
```

应该看到：
- 封面页正常显示
- 可以点击按钮进入登录页

### 5.3 测试完整流程

1. **注册账号**
   - 点击"注册"
   - 输入用户名和密码
   - 应该成功注册并自动登录

2. **创建项目**
   - 登录后进入dashboard
   - 点击"新建项目"
   - 应该能成功创建

3. **生成内容**
   - 选择一个章节
   - 点击"生成"
   - 应该能成功生成内容

---

## 🎉 部署完成！

### 给用户的访问信息

```
========================================
ProReport GenAI - 专业可行性研究报告生成工具
========================================

🌐 访问地址：https://your-app.vercel.app

📱 使用方式：
1. 打开浏览器
2. 访问上述网址
3. 注册账号
4. 开始使用

✅ 优势：
- 无需下载安装
- 支持所有设备
- 自动更新
- 数据云端存储

========================================
```

---

## 🔄 后续更新

### 更新代码

1. 修改代码
2. 提交到GitHub：
   ```bash
   git add .
   git commit -m "更新说明"
   git push
   ```
3. Vercel和Railway会自动检测并重新部署

### 查看日志

**Vercel日志：**
- 项目页面 → Deployments → 点击部署 → 查看构建日志

**Railway日志：**
- 项目页面 → 点击服务 → 查看实时日志

---

## 🆘 遇到问题？

### 前端无法访问后端

1. 检查 `VITE_API_URL` 是否正确
2. 检查后端URL是否可访问
3. 检查浏览器控制台错误信息

### 后端启动失败

1. 检查Railway日志
2. 检查环境变量是否全部配置
3. 检查 `GEMINI_API_KEY` 是否有效

### CORS错误

1. 确保 `FRONTEND_URL` 包含完整URL（带https://）
2. 检查后端CORS配置

---

## 📊 监控和维护

### Vercel监控
- 访问量统计
- 带宽使用
- 部署历史

### Railway监控
- CPU/内存使用
- 请求日志
- 错误监控

---

## 💰 费用

### Vercel
- **免费额度：** 100GB带宽/月
- **适合：** 中小型应用完全免费

### Railway
- **免费额度：** $5/月
- **适合：** 小型应用完全免费
- **超出后：** 按使用量付费（约$0.01/GB RAM小时）

**对于大多数场景，完全免费使用！**

---

完成以上步骤后，你的应用就可以让用户通过浏览器访问了！

